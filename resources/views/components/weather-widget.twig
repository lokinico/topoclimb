{#
    Widget météo pour secteurs d'escalade
    Variables requises:
    - sector: objet secteur avec coordinates_lat, coordinates_lng
#}

{% if sector.coordinates_lat and sector.coordinates_lng %}
<div class="weather-widget info-card" data-lat="{{ sector.coordinates_lat }}" data-lng="{{ sector.coordinates_lng }}" data-sector-id="{{ sector.id }}">
    <h4 class="h5 mb-3">
        <i class="fas fa-cloud-sun me-2 text-primary"></i>Météo locale
    </h4>
    
    <div class="weather-loading text-center py-3">
        <div class="spinner-border spinner-border-sm me-2" role="status">
            <span class="visually-hidden">Chargement...</span>
        </div>
        Récupération de la météo...
    </div>
    
    <div class="weather-content d-none">
        <!-- Météo actuelle -->
        <div class="current-weather mb-3">
            <div class="d-flex align-items-center justify-content-between">
                <div>
                    <div class="weather-temp h4 mb-0">--°</div>
                    <div class="weather-desc text-muted small">--</div>
                </div>
                <div class="weather-icon">
                    <i class="fas fa-sun fa-2x text-warning"></i>
                </div>
            </div>
        </div>
        
        <!-- Détails météo -->
        <div class="weather-details">
            <div class="row text-center">
                <div class="col-4">
                    <div class="small text-muted">Humidité</div>
                    <div class="weather-humidity fw-bold">--%</div>
                </div>
                <div class="col-4">
                    <div class="small text-muted">Vent</div>
                    <div class="weather-wind fw-bold">-- km/h</div>
                </div>
                <div class="col-4">
                    <div class="small text-muted">Pluie</div>
                    <div class="weather-precipitation fw-bold">-- mm</div>
                </div>
            </div>
        </div>
        
        <!-- Recommandation escalade -->
        <div class="climbing-recommendation mt-3 p-2 rounded">
            <div class="d-flex align-items-center">
                <i class="fas fa-mountain recommendation-icon me-2"></i>
                <div>
                    <div class="recommendation-status fw-bold">Conditions à évaluer</div>
                    <div class="recommendation-text small text-muted">Analysez les conditions avant de grimper</div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="weather-error d-none">
        <div class="text-muted small">
            <i class="fas fa-exclamation-triangle me-2"></i>
            Impossible de récupérer la météo
        </div>
    </div>
    
    <div class="weather-updated text-muted small mt-2 d-none">
        Mis à jour: <span class="weather-timestamp">--</span>
    </div>
</div>

<style>
.weather-widget {
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    border: 1px solid #dee2e6;
}

.climbing-recommendation {
    background-color: rgba(var(--bs-success-rgb), 0.1);
    border: 1px solid rgba(var(--bs-success-rgb), 0.25);
}

.climbing-recommendation.warning {
    background-color: rgba(var(--bs-warning-rgb), 0.1);
    border: 1px solid rgba(var(--bs-warning-rgb), 0.25);
}

.climbing-recommendation.danger {
    background-color: rgba(var(--bs-danger-rgb), 0.1);
    border: 1px solid rgba(var(--bs-danger-rgb), 0.25);
}

.weather-icon i {
    filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.1));
}
</style>
{% endif %}